/*! jsmpeg - 0.1.0 - Dominic Szablewski - 295bdb6 - 2014-08-19 */
!function(a){"use strict";var b=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)}}(),c=a.jsmpeg=function(a,b){b=b||{},this.benchmark=!!b.benchmark,this.canvas=b.canvas||document.createElement("canvas"),this.autoplay=!!b.autoplay,this.loop=!!b.loop,this.externalLoadCallback=b.onload||null,this.externalDecodeCallback=b.ondecodeframe||null,this.externalFinishedCallback=b.onfinished||null,this.bwFilter=b.bwFilter||!1,this.customIntraQuantMatrix=new Uint8Array(64),this.customNonIntraQuantMatrix=new Uint8Array(64),this.blockData=new Int32Array(64),this.canvasContext=this.canvas.getContext("2d"),a instanceof WebSocket?(this.client=a,this.client.onopen=this.initSocketClient.bind(this)):this.load(a)};c.prototype.waitForIntraFrame=!0,c.prototype.socketBufferSize=524288,c.prototype.onlostconnection=null,c.prototype.initSocketClient=function(){this.buffer=new D(new ArrayBuffer(this.socketBufferSize)),this.nextPictureBuffer=new D(new ArrayBuffer(this.socketBufferSize)),this.nextPictureBuffer.writePos=0,this.nextPictureBuffer.chunkBegin=0,this.nextPictureBuffer.lastWriteBeforeWrap=0,this.client.binaryType="arraybuffer",this.client.onmessage=this.receiveSocketMessage.bind(this)},c.prototype.decodeSocketHeader=function(a){a[0]==d.charCodeAt(0)&&a[1]==d.charCodeAt(1)&&a[2]==d.charCodeAt(2)&&a[3]==d.charCodeAt(3)&&(this.width=256*a[4]+a[5],this.height=256*a[6]+a[7],this.initBuffers())},c.prototype.receiveSocketMessage=function(a){var c=new Uint8Array(a.data);this.sequenceStarted||this.decodeSocketHeader(c);var d=this.buffer,f=this.nextPictureBuffer;f.writePos+c.length>f.length&&(f.lastWriteBeforeWrap=f.writePos,f.writePos=0,f.index=0),f.bytes.set(c,f.writePos),f.writePos+=c.length;for(var g=0;;){if(g=f.findNextMPEGStartCode(),g==D.NOT_FOUND||f.index>>3>f.writePos)return void(f.index=Math.max(f.writePos-3,0)<<3);if(g==z)break}if(this.waitForIntraFrame)return f.advance(10),void(f.getBits(3)==t&&(this.waitForIntraFrame=!1,f.chunkBegin=f.index-13>>3));this.currentPictureDecoded||this.decodePicture(e);var h=f.index>>3;if(h>f.chunkBegin)d.bytes.set(f.bytes.subarray(f.chunkBegin,h)),d.writePos=h-f.chunkBegin;else{d.bytes.set(f.bytes.subarray(f.chunkBegin,f.lastWriteBeforeWrap));var i=f.lastWriteBeforeWrap-f.chunkBegin;d.bytes.set(f.bytes.subarray(0,h),i),d.writePos=h+i}d.index=0,f.chunkBegin=h,this.currentPictureDecoded=!1,b(this.scheduleDecoding.bind(this),this.canvas)},c.prototype.scheduleDecoding=function(){this.decodePicture(),this.currentPictureDecoded=!0},c.prototype.isRecording=!1,c.prototype.recorderWaitForIntraFrame=!1,c.prototype.recordedFrames=0,c.prototype.recordedSize=0,c.prototype.didStartRecordingCallback=null,c.prototype.recordBuffers=[],c.prototype.canRecord=function(){return this.client&&this.client.readyState==this.client.OPEN},c.prototype.startRecording=function(a){if(this.canRecord()){this.discardRecordBuffers(),this.isRecording=!0,this.recorderWaitForIntraFrame=!0,this.didStartRecordingCallback=a||null,this.recordedFrames=0,this.recordedSize=0;var b=this.width>>4,c=(15&this.width)<<4|this.height>>8,d=255&this.height;this.recordBuffers.push(new Uint8Array([0,0,1,179,b,c,d,19,255,255,225,88,0,0,1,184,0,8,0,0,0,0,1,0]))}},c.prototype.recordFrameFromCurrentBuffer=function(){if(this.isRecording){if(this.recorderWaitForIntraFrame){if(this.pictureCodingType!=t)return;this.recorderWaitForIntraFrame=!1,this.didStartRecordingCallback&&this.didStartRecordingCallback(this)}this.recordedFrames++,this.recordedSize+=this.buffer.writePos,this.recordBuffers.push(new Uint8Array(this.buffer.bytes.subarray(0,this.buffer.writePos)))}},c.prototype.discardRecordBuffers=function(){this.recordBuffers=[],this.recordedFrames=0},c.prototype.stopRecording=function(){var a=new Blob(this.recordBuffers,{type:"video/mpeg"});return this.discardRecordBuffers(),this.isRecording=!1,a},c.prototype.load=function(a){this.url=a;var b=new XMLHttpRequest,c=this;b.onreadystatechange=function(){b.readyState==b.DONE&&200==b.status&&c.loadCallback(b.response)},b.onprogress=this.updateLoader.bind(this),b.open("GET",a),b.responseType="arraybuffer",b.send()},c.prototype.updateLoader=function(a){var b=a.loaded/a.total,c=this.canvas.width,d=this.canvas.height,e=this.canvasContext;e.fillStyle="#222",e.fillRect(0,0,c,d),e.fillStyle="#fff",e.fillRect(0,d-d*b,c,d*b)},c.prototype.loadCallback=function(a){Date.now();this.buffer=new D(a),this.findStartCode(w),this.firstSequenceHeader=this.buffer.index,this.decodeSequenceHeader(),this.nextFrame(),this.autoplay&&this.play(),this.externalLoadCallback&&this.externalLoadCallback(this)},c.prototype.play=function(){this.playing||(this.targetTime=Date.now(),this.playing=!0,this.scheduleNextFrame())},c.prototype.pause=function(){this.playing=!1},c.prototype.stop=function(){this.buffer&&(this.buffer.index=this.firstSequenceHeader),this.playing=!1,this.client&&(this.client.close(),this.client=null)},c.prototype.readCode=function(a){var b=0;do b=a[b+this.buffer.getBits(1)];while(b>=0&&0!=a[b]);return a[b+2]},c.prototype.findStartCode=function(a){for(var b=0;;)if(b=this.buffer.findNextMPEGStartCode(),b==a||b==D.NOT_FOUND)return b;return D.NOT_FOUND},c.prototype.fillArray=function(a,b){for(var c=0,d=a.length;d>c;c++)a[c]=b},c.prototype.pictureRate=30,c.prototype.lateTime=0,c.prototype.firstSequenceHeader=0,c.prototype.targetTime=0,c.prototype.nextFrame=function(){if(this.buffer)for(;;){var a=this.buffer.findNextMPEGStartCode();if(a==w)this.decodeSequenceHeader();else{if(a==z)return this.playing&&this.scheduleNextFrame(),this.decodePicture(),this.canvas;if(a==D.NOT_FOUND)return this.stop(),this.externalFinishedCallback&&this.externalFinishedCallback(this),this.loop&&this.sequenceStarted&&this.play(),null}}},c.prototype.scheduleNextFrame=function(){this.lateTime=Date.now()-this.targetTime;var a=Math.max(0,1e3/this.pictureRate-this.lateTime);if(this.targetTime=Date.now()+a,this.benchmark){var b=Date.now();this.benchframe||(this.benchstart=b,this.benchframe=0),this.benchframe++;var c=b-this.benchstart;this.benchframe>=100&&(this.benchfps=this.benchframe/c*1e3,console&&console.log("frames per second: "+this.benchfps),this.benchframe=null),setTimeout(this.nextFrame.bind(this),0)}else 18>a?this.scheduleAnimation():setTimeout(this.scheduleAnimation.bind(this),a)},c.prototype.scheduleAnimation=function(){b(this.nextFrame.bind(this),this.canvas)},c.prototype.decodeSequenceHeader=function(){if(this.width=this.buffer.getBits(12),this.height=this.buffer.getBits(12),this.buffer.advance(4),this.pictureRate=f[this.buffer.getBits(4)],this.buffer.advance(30),this.initBuffers(),this.buffer.getBits(1)){for(var a=0;64>a;a++)this.customIntraQuantMatrix[g[a]]=this.buffer.getBits(8);this.intraQuantMatrix=this.customIntraQuantMatrix}if(this.buffer.getBits(1)){for(var a=0;64>a;a++)this.customNonIntraQuantMatrix[g[a]]=this.buffer.getBits(8);this.nonIntraQuantMatrix=this.customNonIntraQuantMatrix}},c.prototype.initBuffers=function(){if(this.intraQuantMatrix=h,this.nonIntraQuantMatrix=i,this.mbWidth=this.width+15>>4,this.mbHeight=this.height+15>>4,this.mbSize=this.mbWidth*this.mbHeight,this.codedWidth=this.mbWidth<<4,this.codedHeight=this.mbHeight<<4,this.codedSize=this.codedWidth*this.codedHeight,this.halfWidth=this.mbWidth<<3,this.halfHeight=this.mbHeight<<3,this.quarterSize=this.codedSize>>2,!this.sequenceStarted){this.sequenceStarted=!0;var b=a.Uint8ClampedArray||a.Uint8Array;a.Uint8ClampedArray||(this.copyBlockToDestination=this.copyBlockToDestinationClamp,this.addBlockToDestination=this.addBlockToDestinationClamp),this.currentY=new b(this.codedSize),this.currentY32=new Uint32Array(this.currentY.buffer),this.currentCr=new b(this.codedSize>>2),this.currentCr32=new Uint32Array(this.currentCr.buffer),this.currentCb=new b(this.codedSize>>2),this.currentCb32=new Uint32Array(this.currentCb.buffer),this.forwardY=new b(this.codedSize),this.forwardY32=new Uint32Array(this.forwardY.buffer),this.forwardCr=new b(this.codedSize>>2),this.forwardCr32=new Uint32Array(this.forwardCr.buffer),this.forwardCb=new b(this.codedSize>>2),this.forwardCb32=new Uint32Array(this.forwardCb.buffer),this.canvas.width=this.width,this.canvas.height=this.height,this.currentRGBA=this.canvasContext.getImageData(0,0,this.width,this.height),this.bwFilter&&(this.currentRGBA32=new Uint32Array(this.currentRGBA.data.buffer)),this.fillArray(this.currentRGBA.data,255)}},c.prototype.currentY=null,c.prototype.currentCr=null,c.prototype.currentCb=null,c.prototype.currentRGBA=null,c.prototype.pictureCodingType=0,c.prototype.forwardY=null,c.prototype.forwardCr=null,c.prototype.forwardCb=null,c.prototype.fullPelForward=!1,c.prototype.forwardFCode=0,c.prototype.forwardRSize=0,c.prototype.forwardF=0,c.prototype.decodePicture=function(a){if(this.buffer.advance(10),this.pictureCodingType=this.buffer.getBits(3),this.buffer.advance(16),!(this.pictureCodingType<=0||this.pictureCodingType>=v)){if(this.pictureCodingType==u){if(this.fullPelForward=this.buffer.getBits(1),this.forwardFCode=this.buffer.getBits(3),0==this.forwardFCode)return;this.forwardRSize=this.forwardFCode-1,this.forwardF=1<<this.forwardRSize}var b=0;do b=this.buffer.findNextMPEGStartCode();while(b==A||b==B);for(;b>=x&&y>=b;)this.decodeSlice(255&b),b=this.buffer.findNextMPEGStartCode();if(this.buffer.rewind(32),this.recordFrameFromCurrentBuffer(),a!=e&&(this.bwFilter?this.YToRGBA():this.YCbCrToRGBA(),this.canvasContext.putImageData(this.currentRGBA,0,0),this.externalDecodeCallback&&this.externalDecodeCallback(this,this.canvas)),this.pictureCodingType==t||this.pictureCodingType==u){var c=this.forwardY,d=this.forwardY32,f=this.forwardCr,g=this.forwardCr32,h=this.forwardCb,i=this.forwardCb32;this.forwardY=this.currentY,this.forwardY32=this.currentY32,this.forwardCr=this.currentCr,this.forwardCr32=this.currentCr32,this.forwardCb=this.currentCb,this.forwardCb32=this.currentCb32,this.currentY=c,this.currentY32=d,this.currentCr=f,this.currentCr32=g,this.currentCb=h,this.currentCb32=i}}},c.prototype.YCbCrToRGBA=function(){for(var a,b,c,d,e,f,g=this.currentY,h=this.currentCb,i=this.currentCr,j=this.currentRGBA.data,k=0,l=this.codedWidth,m=this.codedWidth+(this.codedWidth-this.width),n=0,o=this.halfWidth-(this.width>>1),p=0,q=4*this.width,r=4*this.width,s=this.width>>1,t=this.height>>1,u=0;t>u;u++){for(var v=0;s>v;v++)b=h[n],c=i[n],n++,d=c+(103*c>>8)-179,e=(88*b>>8)-44+(183*c>>8)-91,f=b+(198*b>>8)-227,a=g[k++],j[p]=a+d,j[p+1]=a-e,j[p+2]=a+f,p+=4,a=g[k++],j[p]=a+d,j[p+1]=a-e,j[p+2]=a+f,p+=4,a=g[l++],j[q]=a+d,j[q+1]=a-e,j[q+2]=a+f,q+=4,a=g[l++],j[q]=a+d,j[q+1]=a-e,j[q+2]=a+f,q+=4;k+=m,l+=m,p+=r,q+=r,n+=o}},c.prototype.YToRGBA=function(){for(var a,b=this.currentY,c=this.currentRGBA32,d=0,e=this.codedWidth-this.width,f=0,g=this.width,h=this.height,i=0;h>i;i++){for(var j=0;g>j;j++)a=b[d++],c[f++]=4278190080|a<<16|a<<8|a;d+=e}},c.prototype.quantizerScale=0,c.prototype.sliceBegin=!1,c.prototype.decodeSlice=function(a){for(this.sliceBegin=!0,this.macroblockAddress=(a-1)*this.mbWidth-1,this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0,this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.quantizerScale=this.buffer.getBits(5);this.buffer.getBits(1);)this.buffer.advance(8);do this.decodeMacroblock();while(!this.buffer.nextBytesAreStartCode())},c.prototype.macroblockAddress=0,c.prototype.mbRow=0,c.prototype.mbCol=0,c.prototype.macroblockType=0,c.prototype.macroblockIntra=!1,c.prototype.macroblockMotFw=!1,c.prototype.motionFwH=0,c.prototype.motionFwV=0,c.prototype.motionFwHPrev=0,c.prototype.motionFwVPrev=0,c.prototype.decodeMacroblock=function(){for(var a=0,b=this.readCode(k);34==b;)b=this.readCode(k);for(;35==b;)a+=33,b=this.readCode(k);if(a+=b,this.sliceBegin)this.sliceBegin=!1,this.macroblockAddress+=a;else{if(this.macroblockAddress+a>=this.mbSize)return;for(a>1&&(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.pictureCodingType==u&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0));a>1;)this.macroblockAddress++,this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth,this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb),a--;this.macroblockAddress++}this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth,this.macroblockType=this.readCode(C[this.pictureCodingType]),this.macroblockIntra=1&this.macroblockType,this.macroblockMotFw=8&this.macroblockType,0!=(16&this.macroblockType)&&(this.quantizerScale=this.buffer.getBits(5)),this.macroblockIntra?(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0):(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.decodeMotionVectors(),this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb));for(var c=0!=(2&this.macroblockType)?this.readCode(o):this.macroblockIntra?63:0,d=0,e=32;6>d;d++)0!=(c&e)&&this.decodeBlock(d),e>>=1},c.prototype.decodeMotionVectors=function(){var a,b,c=0;this.macroblockMotFw?(a=this.readCode(p),0!=a&&1!=this.forwardF?(c=this.buffer.getBits(this.forwardRSize),b=(Math.abs(a)-1<<this.forwardRSize)+c+1,0>a&&(b=-b)):b=a,this.motionFwHPrev+=b,this.motionFwHPrev>(this.forwardF<<4)-1?this.motionFwHPrev-=this.forwardF<<5:this.motionFwHPrev<-this.forwardF<<4&&(this.motionFwHPrev+=this.forwardF<<5),this.motionFwH=this.motionFwHPrev,this.fullPelForward&&(this.motionFwH<<=1),a=this.readCode(p),0!=a&&1!=this.forwardF?(c=this.buffer.getBits(this.forwardRSize),b=(Math.abs(a)-1<<this.forwardRSize)+c+1,0>a&&(b=-b)):b=a,this.motionFwVPrev+=b,this.motionFwVPrev>(this.forwardF<<4)-1?this.motionFwVPrev-=this.forwardF<<5:this.motionFwVPrev<-this.forwardF<<4&&(this.motionFwVPrev+=this.forwardF<<5),this.motionFwV=this.motionFwVPrev,this.fullPelForward&&(this.motionFwV<<=1)):this.pictureCodingType==u&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0)},c.prototype.copyMacroblock=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o=this.currentY32,p=this.currentCb32,q=this.currentCr32;f=this.codedWidth,g=f-16,h=a>>1,i=b>>1,j=1==(1&a),k=1==(1&b),l=((this.mbRow<<4)+i)*f+(this.mbCol<<4)+h,m=this.mbRow*f+this.mbCol<<2,n=m+(f<<2);var r,s,t;if(j)if(k)for(;n>m;){r=c[l]+c[l+f],l++;for(var u=0;4>u;u++)s=c[l]+c[l+f],l++,t=r+s+2>>2&255,r=c[l]+c[l+f],l++,t|=r+s+2<<6&65280,s=c[l]+c[l+f],l++,t|=r+s+2<<14&16711680,r=c[l]+c[l+f],l++,t|=r+s+2<<22&4278190080,o[m++]=t;m+=g>>2,l+=g-1}else for(;n>m;){r=c[l++];for(var u=0;4>u;u++)s=c[l++],t=r+s+1>>1&255,r=c[l++],t|=r+s+1<<7&65280,s=c[l++],t|=r+s+1<<15&16711680,r=c[l++],t|=r+s+1<<23&4278190080,o[m++]=t;m+=g>>2,l+=g-1}else if(k)for(;n>m;){for(var u=0;4>u;u++)t=c[l]+c[l+f]+1>>1&255,l++,t|=c[l]+c[l+f]+1<<7&65280,l++,t|=c[l]+c[l+f]+1<<15&16711680,l++,t|=c[l]+c[l+f]+1<<23&4278190080,l++,o[m++]=t;m+=g>>2,l+=g}else for(;n>m;){for(var u=0;4>u;u++)t=c[l],l++,t|=c[l]<<8,l++,t|=c[l]<<16,l++,t|=c[l]<<24,l++,o[m++]=t;m+=g>>2,l+=g}if(!this.bwFilter){f=this.halfWidth,g=f-8,h=a/2>>1,i=b/2>>1,j=1==(a/2&1),k=1==(b/2&1),l=((this.mbRow<<3)+i)*f+(this.mbCol<<3)+h,m=this.mbRow*f+this.mbCol<<1,n=m+(f<<1);var v,w,x,y,z,A;if(j)if(k)for(;n>m;){v=d[l]+d[l+f],y=e[l]+e[l+f],l++;for(var u=0;2>u;u++)w=d[l]+d[l+f],z=e[l]+e[l+f],l++,x=v+w+2>>2&255,A=y+z+2>>2&255,v=d[l]+d[l+f],y=e[l]+e[l+f],l++,x|=v+w+2<<6&65280,A|=y+z+2<<6&65280,w=d[l]+d[l+f],z=e[l]+e[l+f],l++,x|=v+w+2<<14&16711680,A|=y+z+2<<14&16711680,v=d[l]+d[l+f],y=e[l]+e[l+f],l++,x|=v+w+2<<22&4278190080,A|=y+z+2<<22&4278190080,q[m]=x,p[m]=A,m++;m+=g>>2,l+=g-1}else for(;n>m;){v=d[l],y=e[l],l++;for(var u=0;2>u;u++)w=d[l],z=e[l++],x=v+w+1>>1&255,A=y+z+1>>1&255,v=d[l],y=e[l++],x|=v+w+1<<7&65280,A|=y+z+1<<7&65280,w=d[l],z=e[l++],x|=v+w+1<<15&16711680,A|=y+z+1<<15&16711680,v=d[l],y=e[l++],x|=v+w+1<<23&4278190080,A|=y+z+1<<23&4278190080,q[m]=x,p[m]=A,m++;m+=g>>2,l+=g-1}else if(k)for(;n>m;){for(var u=0;2>u;u++)x=d[l]+d[l+f]+1>>1&255,A=e[l]+e[l+f]+1>>1&255,l++,x|=d[l]+d[l+f]+1<<7&65280,A|=e[l]+e[l+f]+1<<7&65280,l++,x|=d[l]+d[l+f]+1<<15&16711680,A|=e[l]+e[l+f]+1<<15&16711680,l++,x|=d[l]+d[l+f]+1<<23&4278190080,A|=e[l]+e[l+f]+1<<23&4278190080,l++,q[m]=x,p[m]=A,m++;m+=g>>2,l+=g}else for(;n>m;){for(var u=0;2>u;u++)x=d[l],A=e[l],l++,x|=d[l]<<8,A|=e[l]<<8,l++,x|=d[l]<<16,A|=e[l]<<16,l++,x|=d[l]<<24,A|=e[l]<<24,l++,q[m]=x,p[m]=A,m++;m+=g>>2,l+=g}}},c.prototype.dcPredictorY,c.prototype.dcPredictorCr,c.prototype.dcPredictorCb,c.prototype.blockData=null,c.prototype.decodeBlock=function(a){var b,c=0;if(this.fillArray(this.blockData,0),this.macroblockIntra){var d,e;if(4>a?(d=this.dcPredictorY,e=this.readCode(q)):(d=4==a?this.dcPredictorCr:this.dcPredictorCb,e=this.readCode(r)),e>0){var f=this.buffer.getBits(e);this.blockData[0]=0!=(f&1<<e-1)?d+f:d+(-1<<e|f+1)}else this.blockData[0]=d;4>a?this.dcPredictorY=this.blockData[0]:4==a?this.dcPredictorCr=this.blockData[0]:this.dcPredictorCb=this.blockData[0],this.blockData[0]<<=8,b=this.intraQuantMatrix,c=1}else b=this.nonIntraQuantMatrix;for(var h=0;;){var i=0,k=this.readCode(s);if(1==k&&c>0&&0==this.buffer.getBits(1))break;65535==k?(i=this.buffer.getBits(6),h=this.buffer.getBits(8),0==h?h=this.buffer.getBits(8):128==h?h=this.buffer.getBits(8)-256:h>128&&(h-=256)):(i=k>>8,h=255&k,this.buffer.getBits(1)&&(h=-h)),c+=i;var l=g[c];c++,h<<=1,this.macroblockIntra||(h+=0>h?-1:1),h=h*this.quantizerScale*b[l]>>4,0==(1&h)&&(h-=h>0?1:-1),h>2047?h=2047:-2048>h&&(h=-2048),this.blockData[l]=h*j[l]}1==c?this.fillArray(this.blockData,this.blockData[0]+128>>8):this.IDCT();var m,n,o;4>a?(m=this.currentY,o=this.codedWidth-8,n=this.mbRow*this.codedWidth+this.mbCol<<4,0!=(1&a)&&(n+=8),0!=(2&a)&&(n+=this.codedWidth<<3)):(m=4==a?this.currentCb:this.currentCr,o=(this.codedWidth>>1)-8,n=(this.mbRow*this.codedWidth<<2)+(this.mbCol<<3)),c=0;this.blockData;this.macroblockIntra?this.copyBlockToDestination(this.blockData,m,n,o):this.addBlockToDestination(this.blockData,m,n,o)},c.prototype.copyBlockToDestination=function(a,b,c,d){for(var e=0,f=0;8>f;f++){for(var g=0;8>g;g++)b[c++]=a[e++];c+=d}},c.prototype.addBlockToDestination=function(a,b,c,d){for(var e=0,f=0;8>f;f++){for(var g=0;8>g;g++)b[c++]+=a[e++];c+=d}},c.prototype.copyBlockToDestinationClamp=function(a,b,c,d){for(var e=0,f=0;8>f;f++){for(var g=0;8>g;g++){var h=a[e++];b[c++]=h>255?255:0>h?0:h}c+=d}},c.prototype.addBlockToDestinationClamp=function(a,b,c,d){for(var e=0,f=0;8>f;f++){for(var g=0;8>g;g++){var h=a[e++]+b[c];b[c++]=h>255?255:0>h?0:h}c+=d}},c.prototype.IDCT=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this.blockData;for(s=0;8>s;++s)a=t[32+s],b=t[16+s]+t[48+s],c=t[40+s]-t[24+s],f=t[8+s]+t[56+s],g=t[24+s]+t[40+s],d=t[8+s]-t[56+s],e=f+g,h=t[0+s],m=(473*d-196*c+128>>8)-e,i=m-(362*(f-g)+128>>8),j=h-a,k=(362*(t[16+s]-t[48+s])+128>>8)-b,l=h+a,n=j+k,o=l+b,p=j-k,q=l-b,r=-i-(473*c+196*d+128>>8),t[0+s]=e+o,t[8+s]=m+n,t[16+s]=p-i,t[24+s]=q-r,t[32+s]=q+r,t[40+s]=i+p,t[48+s]=n-m,t[56+s]=o-e;for(s=0;64>s;s+=8)a=t[4+s],b=t[2+s]+t[6+s],c=t[5+s]-t[3+s],f=t[1+s]+t[7+s],g=t[3+s]+t[5+s],d=t[1+s]-t[7+s],e=f+g,h=t[0+s],m=(473*d-196*c+128>>8)-e,i=m-(362*(f-g)+128>>8),j=h-a,k=(362*(t[2+s]-t[6+s])+128>>8)-b,l=h+a,n=j+k,o=l+b,p=j-k,q=l-b,r=-i-(473*c+196*d+128>>8),t[0+s]=e+o+128>>8,t[1+s]=m+n+128>>8,t[2+s]=p-i+128>>8,t[3+s]=q-r+128>>8,t[4+s]=q+r+128>>8,t[5+s]=i+p+128>>8,t[6+s]=n-m+128>>8,t[7+s]=o-e+128>>8};var d="jsmp",e=1,f=[0,23.976,24,25,29.97,30,50,59.94,60,0,0,0,0,0,0,0],g=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),h=new Uint8Array([8,16,19,22,26,27,29,34,16,16,22,24,27,29,34,37,19,22,26,27,29,34,34,38,22,22,26,27,29,34,37,40,22,26,27,29,32,35,40,48,26,27,29,32,35,40,48,58,26,27,29,34,38,46,56,69,27,29,35,38,46,56,69,83]),i=new Uint8Array([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),j=new Uint8Array([32,44,42,38,32,25,17,9,44,62,58,52,44,35,24,12,42,58,55,49,42,33,23,12,38,52,49,44,38,30,20,10,32,44,42,38,32,25,17,9,25,35,33,30,25,20,14,7,17,24,23,20,17,14,9,5,9,12,12,10,9,7,5,2]),k=new Int16Array([3,6,0,9,12,0,0,0,1,15,18,0,21,24,0,27,30,0,33,36,0,0,0,3,0,0,2,39,42,0,45,48,0,0,0,5,0,0,4,51,54,0,57,60,0,0,0,7,0,0,6,63,66,0,69,72,0,75,78,0,81,84,0,-1,87,0,-1,90,0,93,96,0,99,102,0,105,108,0,111,114,0,0,0,9,0,0,8,117,120,0,123,126,0,129,132,0,135,138,0,0,0,15,0,0,14,0,0,13,0,0,12,0,0,11,0,0,10,141,-1,0,-1,144,0,147,150,0,153,156,0,159,162,0,165,168,0,171,174,0,177,180,0,183,-1,0,-1,186,0,189,192,0,195,198,0,201,204,0,207,210,0,213,216,0,219,222,0,0,0,21,0,0,20,0,0,19,0,0,18,0,0,17,0,0,16,0,0,35,0,0,34,0,0,33,0,0,32,0,0,31,0,0,30,0,0,29,0,0,28,0,0,27,0,0,26,0,0,25,0,0,24,0,0,23,0,0,22]),l=new Int8Array([3,6,0,-1,9,0,0,0,1,0,0,17]),m=new Int8Array([3,6,0,9,12,0,0,0,10,15,18,0,0,0,2,21,24,0,0,0,8,27,30,0,33,36,0,-1,39,0,0,0,18,0,0,26,0,0,1,0,0,17]),n=new Int8Array([3,6,0,9,15,0,12,18,0,24,21,0,0,0,12,27,30,0,0,0,14,39,42,0,36,33,0,0,0,4,0,0,6,54,48,0,45,51,0,0,0,8,0,0,10,-1,57,0,0,0,1,60,63,0,0,0,30,0,0,17,0,0,22,0,0,26]),o=new Int16Array([6,3,0,9,18,0,12,15,0,24,33,0,36,39,0,27,21,0,30,42,0,60,57,0,54,48,0,69,51,0,81,75,0,63,84,0,45,66,0,72,78,0,0,0,60,105,120,0,132,144,0,114,108,0,126,141,0,87,93,0,117,96,0,0,0,32,135,138,0,99,123,0,129,102,0,0,0,4,90,111,0,0,0,8,0,0,16,0,0,44,150,168,0,0,0,28,0,0,52,0,0,62,183,177,0,156,180,0,0,0,1,165,162,0,0,0,61,0,0,56,171,174,0,0,0,2,0,0,40,153,186,0,0,0,48,192,189,0,147,159,0,0,0,20,0,0,12,240,249,0,0,0,63,231,225,0,195,219,0,252,198,0,0,0,24,0,0,36,0,0,3,207,261,0,243,237,0,204,213,0,210,234,0,201,228,0,216,222,0,258,255,0,264,246,0,-1,282,0,285,291,0,0,0,33,0,0,9,318,330,0,306,348,0,0,0,5,0,0,10,279,267,0,0,0,6,0,0,18,0,0,17,0,0,34,339,357,0,309,312,0,270,276,0,327,321,0,351,354,0,303,297,0,294,288,0,300,273,0,342,345,0,315,324,0,336,333,0,363,375,0,0,0,41,0,0,14,0,0,21,372,366,0,360,369,0,0,0,11,0,0,19,0,0,7,0,0,35,0,0,13,0,0,50,0,0,49,0,0,58,0,0,37,0,0,25,0,0,45,0,0,57,0,0,26,0,0,29,0,0,38,0,0,53,0,0,23,0,0,43,0,0,46,0,0,42,0,0,22,0,0,54,0,0,51,0,0,15,0,0,30,0,0,39,0,0,47,0,0,55,0,0,27,0,0,59,0,0,31]),p=new Int16Array([3,6,0,12,9,0,0,0,0,18,15,0,24,21,0,0,0,-1,0,0,1,27,30,0,36,33,0,0,0,2,0,0,-2,42,45,0,48,39,0,60,54,0,0,0,3,0,0,-3,51,57,0,-1,69,0,81,75,0,78,63,0,72,66,0,96,84,0,87,93,0,-1,99,0,108,105,0,0,0,-4,90,102,0,0,0,4,0,0,-7,0,0,5,111,123,0,0,0,-5,0,0,7,114,120,0,126,117,0,0,0,-6,0,0,6,153,162,0,150,147,0,135,138,0,156,141,0,129,159,0,132,144,0,0,0,10,0,0,9,0,0,8,0,0,-8,171,198,0,0,0,-9,180,192,0,168,183,0,165,186,0,174,189,0,0,0,-10,177,195,0,0,0,12,0,0,16,0,0,13,0,0,14,0,0,11,0,0,15,0,0,-16,0,0,-12,0,0,-14,0,0,-15,0,0,-11,0,0,-13]),q=new Int8Array([6,3,0,18,15,0,9,12,0,0,0,1,0,0,2,27,24,0,21,30,0,0,0,0,36,33,0,0,0,4,0,0,3,39,42,0,0,0,5,0,0,6,48,45,0,51,-1,0,0,0,7,0,0,8]),r=new Int8Array([6,3,0,12,9,0,18,15,0,24,21,0,0,0,2,0,0,1,0,0,0,30,27,0,0,0,3,36,33,0,0,0,4,42,39,0,0,0,5,48,45,0,0,0,6,51,-1,0,0,0,7,0,0,8]),s=new Int32Array([3,6,0,12,9,0,0,0,1,21,24,0,18,15,0,39,27,0,33,30,0,42,36,0,0,0,257,60,66,0,54,63,0,48,57,0,0,0,513,51,45,0,0,0,2,0,0,3,81,75,0,87,93,0,72,78,0,96,90,0,0,0,1025,69,84,0,0,0,769,0,0,258,0,0,1793,0,0,65535,0,0,1537,111,108,0,0,0,1281,105,102,0,117,114,0,99,126,0,120,123,0,156,150,0,162,159,0,144,147,0,129,135,0,138,132,0,0,0,2049,0,0,4,0,0,514,0,0,2305,153,141,0,165,171,0,180,168,0,177,174,0,183,186,0,0,0,2561,0,0,3329,0,0,6,0,0,259,0,0,5,0,0,770,0,0,2817,0,0,3073,228,225,0,201,210,0,219,213,0,234,222,0,216,231,0,207,192,0,204,189,0,198,195,0,243,261,0,273,240,0,246,237,0,249,258,0,279,276,0,252,255,0,270,282,0,264,267,0,0,0,515,0,0,260,0,0,7,0,0,1026,0,0,1282,0,0,4097,0,0,3841,0,0,3585,315,321,0,333,342,0,312,291,0,375,357,0,288,294,0,-1,369,0,285,303,0,318,363,0,297,306,0,339,309,0,336,348,0,330,300,0,372,345,0,351,366,0,327,354,0,360,324,0,381,408,0,417,420,0,390,378,0,435,438,0,384,387,0,0,0,2050,396,402,0,465,462,0,0,0,8,411,399,0,429,432,0,453,414,0,426,423,0,0,0,10,0,0,9,0,0,11,0,0,5377,0,0,1538,0,0,771,0,0,5121,0,0,1794,0,0,4353,0,0,4609,0,0,4865,444,456,0,0,0,1027,459,450,0,0,0,261,393,405,0,0,0,516,447,441,0,516,519,0,486,474,0,510,483,0,504,498,0,471,537,0,507,501,0,522,513,0,534,531,0,468,477,0,492,495,0,549,546,0,525,528,0,0,0,263,0,0,2562,0,0,2306,0,0,5633,0,0,5889,0,0,6401,0,0,6145,0,0,1283,0,0,772,0,0,13,0,0,12,0,0,14,0,0,15,0,0,517,0,0,6657,0,0,262,540,543,0,480,489,0,588,597,0,0,0,27,609,555,0,606,603,0,0,0,19,0,0,22,591,621,0,0,0,18,573,576,0,564,570,0,0,0,20,552,582,0,0,0,21,558,579,0,0,0,23,612,594,0,0,0,25,0,0,24,600,615,0,0,0,31,0,0,30,0,0,28,0,0,29,0,0,26,0,0,17,0,0,16,567,618,0,561,585,0,654,633,0,0,0,37,645,648,0,0,0,36,630,636,0,0,0,34,639,627,0,663,666,0,657,624,0,651,642,0,669,660,0,0,0,35,0,0,267,0,0,40,0,0,268,0,0,266,0,0,32,0,0,264,0,0,265,0,0,38,0,0,269,0,0,270,0,0,33,0,0,39,0,0,7937,0,0,6913,0,0,7681,0,0,4098,0,0,7425,0,0,7169,0,0,271,0,0,274,0,0,273,0,0,272,0,0,1539,0,0,2818,0,0,3586,0,0,3330,0,0,3074,0,0,3842]),t=1,u=2,v=3,w=179,x=1,y=175,z=0,A=181,B=178,C=[null,l,m,n],D=function(a){this.bytes=new Uint8Array(a),this.length=this.bytes.length,this.writePos=this.bytes.length,this.index=0};D.NOT_FOUND=-1,D.prototype.findNextMPEGStartCode=function(){for(var a=this.index+7>>3;a<this.writePos;a++)if(0==this.bytes[a]&&0==this.bytes[a+1]&&1==this.bytes[a+2])return this.index=a+4<<3,this.bytes[a+3];return this.index=this.writePos<<3,D.NOT_FOUND},D.prototype.nextBytesAreStartCode=function(){var a=this.index+7>>3;return a>=this.writePos||0==this.bytes[a]&&0==this.bytes[a+1]&&1==this.bytes[a+2]},D.prototype.nextBits=function(a){var b=this.index>>3,c=8-this.index%8;if(c>=a)return this.bytes[b]>>c-a&255>>8-a;var d=(this.index+a)%8,e=this.index+a-1>>3,f=this.bytes[b]&255>>8-c;for(b++;e>b;b++)f<<=8,f|=this.bytes[b];return d>0?(f<<=d,f|=this.bytes[b]>>8-d):(f<<=8,f|=this.bytes[b]),f},D.prototype.getBits=function(a){var b=this.nextBits(a);return this.index+=a,b},D.prototype.advance=function(a){return this.index+=a},D.prototype.rewind=function(a){return this.index-=a}}(window);